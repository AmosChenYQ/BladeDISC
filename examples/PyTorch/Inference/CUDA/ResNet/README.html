

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DISC optimization example for PyTorch ResNet model. &mdash; BladeDISC 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../../../../../index.html">
                BladeDISC
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a></li>
        
      <li>DISC optimization example for PyTorch ResNet model.</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/examples/PyTorch/Inference/CUDA/ResNet/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../../../../../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../README.html">BladeDISC Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#api-quickview">API QuickView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#setup-and-examples">Setup and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#tutorials-and-documents-for-developers">Tutorials and Documents for Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#presentations-and-talks">Presentations and Talks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#how-to-contribute">How to Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#building-status">Building Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#faq">FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../README.html#contact-us">Contact Us</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docs/install_with_docker.html">Install with Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/install_with_docker.html#download-a-bladedisc-docker-image">Download a BladeDISC Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/install_with_docker.html#start-a-docker-container">Start a Docker Container</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docs/build_from_source.html">Build from Source</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/build_from_source.html#prerequisite">Prerequisite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/build_from_source.html#checkout-the-source">Checkout the Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/build_from_source.html#launch-a-development-docker-container">Launch a development Docker container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/build_from_source.html#building-bladedisc-for-tensorflow-users">Building BladeDISC for TensorFlow Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/build_from_source.html#building-bladedisc-for-pytorch-users">Building BladeDISC for PyTorch Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docs/quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/quickstart.html#quickstart-for-tensorflow-users">Quickstart for TensorFlow Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/quickstart.html#quickstart-for-pytorch-users">Quickstart for PyTorch Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docs/contribution.html">How to Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/contribution.html#local-development-environment">Local Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/contribution.html#submit-a-pull-request-to-bladedisc">Submit a Pull Request to BladeDISC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docs/tutorials/index.html">Tutorials on Example Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/tutorials/tensorflow_inference_and_training.html">Use case of TensorFlow Inference and Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../docs/tutorials/torch_bert_inference.html">Use case of PyTorch Inference</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="disc-optimization-example-for-pytorch-resnet-model">
<h1>DISC optimization example for PyTorch ResNet model.<a class="headerlink" href="#disc-optimization-example-for-pytorch-resnet-model" title="Permalink to this heading">¶</a></h1>
<p>The ResNet model is based on the <a class="reference external" href="https://arxiv.org/abs/1512.03385">Deep Residual Learning for Image Recognition</a> paper.</p>
<p>This repository uses the
<a class="reference external" href="https://pytorch.org/vision/stable/models/resnet.html">model mantained in torchvision</a>.</p>
<section id="configure-and-run">
<h2>Configure and run.<a class="headerlink" href="#configure-and-run" title="Permalink to this heading">¶</a></h2>
<p>These python packages are required for executing this example:</p>
<ul class="simple">
<li><p>torch &gt;= 1.6.0</p></li>
<li><p>torchvision</p></li>
<li><p>torch_blade</p></li>
</ul>
<p>To build and install <code class="docutils literal notranslate"><span class="pre">torch_blade</span></code> package, please refer to
<a class="reference external" href="../../../../docs/build_from_source">“Build BladeDISC from source”</a> and
<a class="reference external" href="../../../../docs/install_with_docker">“Install BladeDISC with Docker”</a>.</p>
<p>You can run the example with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python main.py
</pre></div>
</div>
<p>It will run optimizations of BladeDISC.</p>
</section>
<section id="performance-results">
<h2>Performance results.<a class="headerlink" href="#performance-results" title="Permalink to this heading">¶</a></h2>
<p>We evaluate this example on A10 GPU, The CUDA version is 11.3. CuDNN version is
8.3. PyTorch version is 1.12.0. The speedup reports on ResNet50 of the 200 inferences
is as following.</p>
<section id="python-main-py">
<h3><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">main.py</span></code><a class="headerlink" href="#python-main-py" title="Permalink to this heading">¶</a></h3>
<p>|    | Backend   |   batch | precision   |   Median(FPS) |   Mean(FPS) |   Median(ms) |   Mean(ms) |    99th_p |     std_dev |
|—:|:———-|——–:|:————|————–:|————:|————-:|———–:|———-:|————:|
|  0 | PyTorch   |      32 | fp32        |       930.02  |     930.859 |    0.0344079 |  0.0343776 | 0.0347254 | 0.000162988 |
|  1 |TorchScript|      32 | fp32        |       918.961 |     918.161 |    0.034822  |  0.0348532 | 0.0353194 | 0.000177631 |
|  2 | DISC      |      32 | fp32        |      1130.83  |    1131.88  |    0.0282977 |  0.0282732 | 0.0287687 | 0.000219865 |</p>
</section>
<section id="python-main-py-fp16">
<h3><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">main.py</span> <span class="pre">--fp16</span></code><a class="headerlink" href="#python-main-py-fp16" title="Permalink to this heading">¶</a></h3>
<p>|    | Backend   |   batch | precision   |   Median(FPS) |   Mean(FPS) |   Median(ms) |   Mean(ms) |    99th_p |     std_dev |
|—:|:———-|——–:|:————|————–:|————:|————-:|———–:|———-:|————:|
|  0 | PyTorch   |      32 | fp16        |       1870.41 |     1866.49 |    0.0171085 |  0.017145  | 0.0173835 | 9.1966e-05  |
|  1 |TorchScript|      32 | fp16        |       1803.68 |     1803.2  |    0.0177415 |  0.0177472 | 0.0180768 | 0.000129273 |
|  2 | DISC      |      32 | fp16        |       2311.53 |     2298.32 |    0.0138436 |  0.0139253 | 0.0145824 | 0.000170253 |</p>
</section>
<section id="python-main-py-amp">
<h3><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">main.py</span> <span class="pre">--amp</span></code><a class="headerlink" href="#python-main-py-amp" title="Permalink to this heading">¶</a></h3>
<p>|    | Backend   |   batch | precision   |   Median(FPS) |   Mean(FPS) |   Median(ms) |   Mean(ms) |    99th_p |     std_dev |
|—:|:———-|——–:|:————|————–:|————:|————-:|———–:|———-:|————:|
|  0 | PyTorch   |      32 | amp         |       1898.59 |     1895.44 |    0.0168546 |  0.016883  | 0.017094  | 8.18696e-05 |
|  1 |TorchScript|      32 | amp         |       1837.09 |     1833.55 |    0.0174189 |  0.0174531 | 0.0176906 | 0.000100789 |
|  2 | DISC      |      32 | amp         |       2279.53 |     2282.38 |    0.014038  |  0.0140209 | 0.0142996 | 7.63628e-05 |</p>
<p>DISC shows speedups over all configurations.</p>
</section>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../',
            VERSION:'1.0.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../../../../../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright bladedisc-dev@list.alibaba-inc.com.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.
        </div>
    </div>  

</body>
</html>